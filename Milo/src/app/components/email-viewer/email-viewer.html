<div class="reading-pane">

  <!-- Empty State (Only shows if email is null) -->
  <div *ngIf="!email" class="empty-state">
    <div class="empty-icon-circle">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
      </svg>
    </div>
    <p>Select an email to read</p>
  </div>

  <!-- Content State -->
  <div *ngIf="email" class="email-content">
    <!-- Email Header -->
    <div class="view-header">
      <div class="subject-row">
        <!-- Safe Navigation (?) prevents null errors -->
        <h2 class="subject">{{email.subject}}</h2>
      </div>

      <div class="sender-info">
        <div class="meta">
          <div class="meta-top">
            <span class="sender-name">{{email.sender}}</span>
            <span class="timestamp">{{email.time | date:'dd/MM hh:mm a'}}</span>
          </div>
          <p class="sender-email">{{email.senderEmail}}</p>
        </div>
      </div>
    </div>

    <!-- Email Body -->
    <div class="email-body-text">
      {{email.body}}
    </div>

    <!-- Attachments Section -->
    <div *ngIf="email.attachments?.length" class="attachments-section">
      <h4 class="attachments-title">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
          stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.112 2.13" />
        </svg>
        {{email.attachments?.length}} Attachments
      </h4>

      <div class="attachments-list">
        <!-- Loop through attachments -->
        <div *ngFor="let file of email.attachments" class="attachment-item" (click)="downloadFile(file)"
          style="cursor: pointer;">
          <div class="file-icon">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
            </svg>
          </div>

          <div class="file-info">
            <span class="file-name">{{file.fileName}}</span>
            <!-- <span class="file-size" *ngIf="file.size">{{file.size}}</span> -->
          </div>

          <!-- Download Button -->
          <button class="download-btn" title="Download" (click)="downloadFile(file); $event.stopPropagation()">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
            </svg>
          </button>
        </div>
      </div>
    </div>

  </div>
</div>
